import common -;

namespace m_globals2;
import meta::builtin m;

struct bar {
  int f1;
  long f2;
  function int hoge(int x, string y) {
    return x;
  }
  function ptr{string} fuga(int x, string y) {
    ptr{string} r = ptr{string}(y);
    return r;
  }
}

macro ns_types m::types{"m_globals2"};
macro finfo{f} m::concat{
  f, ":",
  m::rettype{f}, ":",
  m::argtypes{f}};
macro tinfo{t} m::concat{
  t, ":",
  m::field_names{t}, ":",
  m::field_types{t}, ":",
  m::metamap{m::member_functions{t}, finfo}};
println(m::to_string{m::metamap{ns_types, tinfo}});

