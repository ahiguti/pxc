namespace e3;
import common -;
import meta::builtin m;

interface ifoo {
  function string hoge(string x);
  function string fuga(string x);
}

interface ibar {
  function string abc(string x);
  function string xyz(string x);
}

macro mf_str{t} m::metamap{m::member_functions{t}, meta::builtin::to_string};

struct {ityp} foo : ityp : {
  expand(fsym : mf_str{ityp})
  function string fsym(string x) {
    string s = m::to_string{fsym};
    s.append(":");
    s.append(x);
    return s;
  }
}
/*
*/

function void test1() {
  println(m::full_string{m::member_functions{ifoo}});
  var p = ptr{foo{ifoo}}(foo{ifoo}());
  println(p->hoge("A"));
  println(p->fuga("B"));
}

test1();
