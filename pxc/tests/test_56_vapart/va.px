namespace va;
import common -;
import meta m;

metafunction argname{i} m::concat{"a", i};
metafunction arginfo{lst, i} m::list{argname{i}, m::at{lst, i}, 1, 0};

function {f, ns, lst} string
vafunc(expand(m::map{m::seq{m::size{lst}}, arginfo, lst}))
{
  string r;
  expand(arg, idx : m::map{m::seq{m::size{lst}}, argname}) {
    r.append(m::symbol{f, ns, m::at{lst, idx}}(arg));
  }
  return r;
}

function void test1()
{
  int a = 10;
  string b = "[abc]";
  double c = 12.5;
  string s = vafunc{"to_string", "string::conversion",
    m::list{int, string, double}}(a, b, c);
  println(s);
  string s2 = vafunc{"to_string", "string::conversion",
    m::list{string, int}}(b, a);
  println(s2);
}

test1();

