namespace addr;
import common -;
import io::net::addrinfo -;

function void t1()
{
  gai_error_t gaie;
  var ai = addrinfo(io::system, "localhost", "", AF_INET, SOCK_STREAM,
    PROTO_UNSPEC, 0, gaie);
  print("empty=");
  println(ai.empty());
  if (gaie != gai_error_t()) {
    print("error=");
    println(gaie);
  }
  sockaddr_storage sa = ai.get_sockaddr();
  println("addr=");
  ulong a = sa.get_in_addr();
  println((a >> 24) & 255);
  println((a >> 16) & 255);
  println((a >> 8) & 255);
  println((a >> 0) & 255);
}

t1();

