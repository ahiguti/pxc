
namespace up1;
import test_common "";

function {t, f} void array_foreach(t& v)
{
  ulong sz = v.size();
  ulong i;
  for (i = 0; i < sz; ++i) {
    f(v[i]);
  }
}

function void foo(vector{int}& v) {
  int x;
  function void bar(int y) {
    x += y;
  }
  array_foreach{vector{int}, bar}(v);
  io::println(x);
}

vector{int} a;
a.resize(101);
int i;
for (i = 0; i < a.size(); ++i) {
  a[i] = i;
}
foo(a);

