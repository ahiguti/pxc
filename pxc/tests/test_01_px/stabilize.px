
namespace stabilize;
import common -;

struct intpair {
  int first;
  int second;
  function int add() { return first + second; }
}

metafunction intptr ptr{int};
metafunction intpairptr ptr{intpair};
metafunction intpairarr vector{intpair};
metafunction intpairptrarr vector{intpairptr};

function intptr add_intptr(intptr xr, intptr yr)
{
  intptr r = to_ptr{int}(*xr + *yr);
  return r;
}

function void sttest1()
{
  int x = 3;
  intptr xr = to_ptr{int}(x);
  int y = 4;
  intptr yr = to_ptr{int}(y);
  intptr zr = add_intptr(xr, yr);
  println(*zr);
}

function void sttest2()
{
  intpairptr x = to_ptr{intpair}(intpair());
  x->first = 5;
  x->second = 8;
  println(x->add());
}

sttest1();
sttest2();

