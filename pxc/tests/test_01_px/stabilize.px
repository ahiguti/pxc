
namespace stabilize;
import test_common "";

struct intpair {
  int first;
  int second;
  function int add() { return first + second; }
}

macro intptr ptr{int};
macro intpairptr ptr{intpair};
macro intpairarr vector{intpair};
macro intpairptrarr vector{intpairptr};

function intptr add_intptr(intptr xr, intptr yr)
{
  intptr r = ptr(*xr + *yr);
  return r;
}

function void sttest1()
{
  int x = 3;
  intptr xr = ptr(x);
  int y = 4;
  intptr yr = ptr(y);
  intptr zr = add_intptr(xr, yr);
  io::println(*zr);
}

function void sttest2()
{
  intpairptr x = ptr(intpair());
  x->first = 5;
  x->second = 8;
  io::println(x->add());
}

sttest1();
sttest2();

