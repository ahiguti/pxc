
// vim: syntax=javascript:sw=2:ts=8

namespace ptrtest;
private import io;

macro ulongref ref{ulong};
macro ulongcref cref{ulong};

function ulongref addptr(ulongref ap, ulongref bp)
{
  return ref(*ap + *bp);
  ulongref r = ref(*ap + *bp);
  return r;
}

struct foo {
  int fx;
  int fy;
}

{
  ulongref x = ref(3U);
  ulongref y = ref(4U);
  ulongcref z = addptr(x, y);
  // var z:(cref ulong int) = addptr(x, y);
  // *z = 99;
  // &3 = z;
  io::println(*z);
}

{
  ref{foo} fp = ref(foo());
  fp->fx = 3;
  fp->fy = 4;
  io::println(fp->fx * fp->fy);
}

